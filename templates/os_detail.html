{% extends "base.html" %}
{% block content %}
<h3>Chamado #{{ c.id }}</h3>
<div class="card">
  <div class="card-body">
    <h5 class="card-title">{{ c.titulo }}</h5>
    <p class="card-text" style="white-space: pre-wrap;">{{ c.descricao }}</p>
    <ul class="list-group list-group-flush">
      <li class="list-group-item"><strong>Status:</strong> {{ c.status }}</li>
      <li class="list-group-item"><strong>Data Abertura:</strong> {{ c.data_abertura.strftime('%d/%m/%Y %H:%M') if c.data_abertura else '' }}</li>
      <li class="list-group-item"><strong>Data Fechamento:</strong> {{ c.data_fechamento.strftime('%d/%m/%Y %H:%M') if c.data_fechamento else '' }}</li>
      <li class="list-group-item"><strong>Criado por:</strong> {{ c.criador.username if c.criador else '' }}</li>
      <li class="list-group-item"><strong>Fechado por:</strong> {{ c.fechador.username if c.fechador else '' }}</li>
      <li class="list-group-item"><strong>Resolução:</strong><br><span style="white-space: pre-wrap;">{{ c.resolucao or '' }}</span></li>
    </ul>
    <div class="mt-3">
      <a class="btn btn-secondary" href="{{ url_for('dashboard') }}">Voltar</a>
      {% if user.has_permission('edit_tickets') %}
        <a class="btn btn-primary" href="{{ url_for('editar_chamado', chamado_id=c.id) }}">Editar</a>
      {% endif %}
      {% if user.has_permission('close_tickets') and c.status == 'Aberto' %}
        <a class="btn btn-success" href="{{ url_for('fechar_chamado', chamado_id=c.id) }}">Fechar Chamado</a>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
