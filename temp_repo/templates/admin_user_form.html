{% extends "base.html" %}
{% block content %}
<h3>{{ 'Novo usuário' if modo=='novo' else 'Editar usuário' }}</h3>
<div class="card shadow-sm">
  <div class="card-body">
    <form method="post">
      <div class="mb-3">
        <label class="form-label">Usuário</label>
        <input class="form-control" type="text" name="username" value="{{ u.username if u }}" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Perfil</label>
        <select class="form-select" name="role" required>
          {% set roles = ['admin','operador','usuario'] %}
          {% for r in roles %}
            <option value="{{ r }}" {% if u and u.role==r %}selected{% endif %}>{{ r }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label">Senha {{ '(deixe em branco para manter)' if modo=='editar' }}</label>
        <input class="form-control" type="password" name="password" {% if modo=='novo' %}required{% endif %}>
      </div>
      <button class="btn btn-primary">Salvar</button>
      <a class="btn btn-secondary" href="{{ url_for('admin_users') }}">Cancelar</a>
    </form>
  </div>
</div>
{% endblock %}
