{% extends 'base.html' %}
{% block content %}
<h4>{{ 'Editar Usuário' if u else 'Novo Usuário' }}</h4>
<div class="card">
  <div class="card-body">
    {% if erro %}<div class="alert alert-danger">{{ erro }}</div>{% endif %}
    <form method="post">
      <div class="mb-3">
        <label class="form-label">Usuário</label>
        <input class="form-control" name="username" value="{{ u.username if u else '' }}" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Senha {% if u %}<small class="text-muted">(deixe em branco para manter)</small>{% endif %}</label>
        <input class="form-control" type="password" name="password" {% if not u %}required{% endif %}>
      </div>
      <div class="mb-3">
        <label class="form-label">Papel</label>
        <select class="form-select" name="role">
          {% for r in ['admin','operador','usuario'] %}
            <option value="{{ r }}" {% if u and u.role==r %}selected{% endif %}>{{ r }}</option>
          {% endfor %}
        </select>
      </div>
      <button class="btn btn-primary">Salvar</button>
      <a class="btn btn-secondary" href="{{ url_for('usuarios_list') }}">Cancelar</a>
    </form>
  </div>
</div>
{% endblock %}
